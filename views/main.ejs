<%- include('./partials/head') %>
<%- include('./partials/nav') %>

<section class="wrapper pt-5 bg-light">
    <div class="card col-lg-6 offset-lg-3 mt-5">
        <div class="card-header">
          <h2>Your TODOs</h2>
        </div>
        <% if (error !== null) { %>
          <div class="alert alert-danger mx-5 mt-4 mb-0" role="alert">
            <% if (error === 'delete') { %>
              An error occured while trying to delete todo.
            <% } else if (error ==='create') { %>
              And error occured while creating todo.
            <% } else { %>
              An unknown error has occured.
            <% } %>
          </div>
        <% } %>

        <div class="card-body mx-5 mb-4 mt-4">
          <table class="table table-hover">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Title</th>
                <th scope="col">Description</th>
                <th scope="col">Delete</th>
              </tr>
            </thead>
            <tbody>
              <form method="POST">
                <tr>
                  <th scope="row">0</th>
                  <td><input class="form-control" type="text" name="title" id="title" placeholder="Title" required></td>
                  <td><input class="form-control" type="text" name="description" id="description" placeholder="Description" required></td>
                  <td><button class="btn btn-primary" type="submit" style="width: 100%;">Add</button></td>
                </tr>
              </form>
              <% todos.forEach((todo, index) => { %>
                <tr>
                  <th scope="row"><%= index + 1 %></th>
                  <td><%= todo.title %></td>
                  <td><%= todo.description %></td>
                  <td><form method="post" action="/todos/delete">
                    <input type="hidden" name="todoId" value="<%= todo.id %>">
                    <button class="btn btn-danger" type="submit" style="width: 100%;">Delete</button>
                  </form></td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      </div>
</section>

<%- include('./partials/footer') %>
